<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>æ˜ŸæŸ±è¡“ï½œæ€§æ ¼è¨ºæ–­ï¼ˆMVPï¼‰</title>
<meta name="description" content="è¥¿æ´‹å æ˜Ÿè¡“Ã—å››æŸ±æ¨å‘½ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å è¡“ã€æ˜ŸæŸ±è¡“ã€ã®æ€§æ ¼è¨ºæ–­ã€‚ç”Ÿå¹´æœˆæ—¥ã‚’å…¥ã‚Œã‚‹ã ã‘ã§è¦ç‚¹ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã€‚" />
<!-- OGP / Twitter Card -->
<meta property="og:type" content="website" />
<meta property="og:title" content="æ˜ŸæŸ±è¡“ï½œæ€§æ ¼è¨ºæ–­ï¼ˆMVPï¼‰" />
<meta property="og:description" content="è¥¿æ´‹å æ˜Ÿè¡“Ã—å››æŸ±æ¨å‘½ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å è¡“ã€æ˜ŸæŸ±è¡“ã€ã®æ€§æ ¼è¨ºæ–­ã€‚ç”Ÿå¹´æœˆæ—¥ã‚’å…¥ã‚Œã‚‹ã ã‘ã§è¦ç‚¹ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã€‚" />
<meta property="og:url" content="https://hoshichu-jutsu.github.io/seichu-jutsu/" />
<meta property="og:image" content="https://hoshichu-jutsu.github.io/seichu-jutsu/og.png" />
<meta name="twitter:card" content="summary_large_image" />
<style>
  :root{
    --accent:#ff7a00; --accent-2:#ffcc99;
    --fg:#1f2937; --muted:#6b7280; --line:#e5e7eb; --card:#ffffff;
    --bg:#ffffff;
  }
  @media (prefers-color-scheme: dark){
    :root{ --fg:#e5e7eb; --muted:#9ca3af; --line:#374151; --card:#111827; --bg:#0b0f16; }
  }
  [data-theme="dark"]{ --fg:#e5e7eb; --muted:#9ca3af; --line:#374151; --card:#111827; --bg:#0b0f16; }
  html,body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;line-height:1.6}
  header{position:sticky;top:0;backdrop-filter:saturate(180%) blur(8px);background:color-mix(in srgb,var(--bg) 80%, transparent);border-bottom:1px solid var(--line);padding:14px 16px;z-index:10}
  .bar{max-width:1000px;margin:0 auto;display:flex;gap:12px;align-items:center;justify-content:space-between}
  .brand{display:flex;gap:10px;align-items:center}
  .logo{width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#ffa74d);box-shadow:0 4px 14px rgba(0,0,0,.15)}
  .title{margin:0;font-size:18px;font-weight:800}
  .actions{display:flex;gap:8px}
  .icon-btn{border:1px solid var(--line);background:var(--card);color:var(--fg);padding:8px 10px;border-radius:10px;cursor:pointer}
  main{max-width:1000px;margin:20px auto 80px;padding:0 16px}
  .card{border:1px solid var(--line);border-radius:16px;padding:18px;background:var(--card);box-shadow:0 10px 30px rgba(0,0,0,.06);margin:12px 0}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:760px){.grid{grid-template-columns:repeat(4,1fr)}}
  label{font-size:12px;color:var(--muted);display:block;margin:0 0 6px}
  input{width:100%;padding:12px 14px;border:1px solid var(--line);border-radius:12px;font-size:14px;background:var(--bg);color:var(--fg)}
  input:focus{outline:3px solid color-mix(in srgb,var(--accent) 30%, transparent);border-color:var(--accent)}
  .btn{background:var(--accent);color:#fff;border:0;border-radius:999px;padding:14px 18px;font-weight:800;cursor:pointer}
  .btn.secondary{background:transparent;color:var(--fg);border:1px solid var(--line)}
  .inline{display:flex;gap:8px;flex-wrap:wrap}
  .kicker{color:var(--muted);font-size:12px;margin-bottom:8px}
  .h2{font-size:18px;font-weight:800;margin:.2em 0 .6em}
  .tag{display:inline-block;background:color-mix(in srgb,var(--accent-2) 30%, transparent);color:var(--fg);border:1px solid var(--line);border-radius:999px;padding:4px 10px;font-size:12px;margin:0 6px 6px 0}
  .pill{display:inline-block;background:color-mix(in srgb,#999 10%, transparent);border:1px solid var(--line);border-radius:999px;padding:6px 12px;font-size:12px;margin:0 6px 8px 0}
  .cards{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:900px){.cards{grid-template-columns:1fr 1fr 1fr}}
  .bullet{margin:8px 0 0;padding-left:18px}
  .bullet li{margin:6px 0}
  .warn{background:color-mix(in srgb,#ffcc66 20%, transparent);border-left:4px solid #ffcc66;padding:10px 12px;border-radius:8px}
  .share{display:flex;gap:8px;flex-wrap:wrap;margin-top:14px}
  .share-btn{background:#0ea5e9;color:#fff;padding:10px 14px;border-radius:10px;text-decoration:none;display:inline-flex;align-items:center;gap:8px;font-size:14px}
  .copy-btn{background:#111827;color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer}
  .toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:#111827;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;pointer-events:none;transition:opacity .2s, transform .2s}
  .toast.show{opacity:1;transform:translateX(-50%) translateY(-6px)}
</style>
</head>
<body>
<header>
  <div class="bar">
    <div class="brand"><div class="logo" aria-hidden="true"></div><p class="title">æ˜ŸæŸ±è¡“ï½œæ€§æ ¼è¨ºæ–­ï¼ˆMVPï¼‰</p></div>
    <div class="actions">
      <button id="themeBtn" class="icon-btn" aria-label="ãƒ†ãƒ¼ãƒåˆ‡æ›¿">ğŸŒ“</button>
    </div>
  </div>
</header>
<main>
  <div class="card">
    <div class="kicker">å…¥åŠ›</div>
    <div class="grid" style="align-items:end">
      <div>
        <label for="birthDate">ç”Ÿå¹´æœˆæ—¥</label>
        <input type="date" id="birthDate" />
      </div>
      <div>
        <label for="birthTime">å‡ºç”Ÿæ™‚é–“ï¼ˆä»»æ„ï¼‰</label>
        <input type="time" id="birthTime" />
      </div>
      <div>
        <label for="birthPlace">å‡ºç”Ÿåœ°ï¼ˆä»»æ„ãƒ»è¡¨ç¤ºç”¨ï¼‰</label>
        <input type="text" id="birthPlace" placeholder="ä¾‹ï¼šåºƒå³¶çœŒ" />
      </div>
      <div class="inline">
        <button id="calcBtn" class="btn">æ€§æ ¼è¨ºæ–­ã‚’ç”Ÿæˆ</button>
        <button id="resetBtn" class="btn secondary">ãƒªã‚»ãƒƒãƒˆ</button>
      </div>
    </div>
    <p class="kicker" style="margin-top:8px">â€»MVPç°¡æ˜“ç‰ˆï¼šå¤ªé™½æ˜Ÿåº§ï¼ˆè¥¿æ´‹ï¼‰ï¼‹æœˆæ˜Ÿåº§ï¼ˆç°¡æ˜“ï¼‰ï¼‹å¹´æŸ±ï¼ˆå››æŸ±ï¼‰ã§è¦ç‚¹ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã€‚ç²¾å¯†ç‰ˆã§ã¯æœˆæŸ±ãƒ»æ—¥æŸ±ãƒ»é‡‘æ˜Ÿãƒ»ç«æ˜Ÿã»ã‹ã‚’è¿½åŠ äºˆå®šã€‚</p>
  </div>

  <div id="result" class="card" style="display:none">
    <div class="kicker">çµæœ</div>
    <div class="h2">æ¦‚è¦</div>
    <div id="summary"></div>

    <div class="cards" style="margin-top:12px">
      <div class="card">
        <div class="kicker">è¥¿æ´‹æ€§æ ¼</div>
        <div id="western"></div>
      </div>
      <div class="card">
        <div class="kicker">å››æŸ±æ€§æ ¼</div>
        <div id="eastern"></div>
      </div>
      <div class="card">
        <div class="kicker">æ˜ŸæŸ±ã‚¯ãƒ­ã‚¹è¨ºæ–­ï¼ˆè¦ç‚¹ï¼‰</div>
        <div id="hybrid"></div>
      </div>
    </div>

    <div class="warn" style="margin-top:16px">
      <strong>ã”æ³¨æ„ï¼š</strong> æœ¬MVPã¯ç°¡æ˜“ãƒ­ã‚¸ãƒƒã‚¯ã§ã™ã€‚æœˆæ˜Ÿåº§ã¯æ—¥ä»˜ãƒ¬ãƒ³ã‚¸ã«ã‚ˆã‚‹æ¨å®šã®ãŸã‚èª¤å·®ãŒå‡ºã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚å‡ºç”Ÿæ™‚é–“ãŒåˆ†ã‹ã‚Œã°ç²¾å¯†ç‰ˆã§å¤§å¹…ã«å‘ä¸Šã—ã¾ã™ã€‚
    </div>

    <div class="share">
      <a href="#" id="shareBtn" class="share-btn">ğŸ”— Xï¼ˆTwitterï¼‰ã§å…±æœ‰</a>
      <button id="copyBtn" class="copy-btn">ğŸ“‹ ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>
  </div>
</main>
<div id="toast" class="toast" role="status" aria-live="polite">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ</div>

<script>
  // ===== ãƒ†ãƒ¼ãƒåˆ‡æ›¿
  const root = document.documentElement;
  document.getElementById('themeBtn').addEventListener('click',()=>{
    if(root.getAttribute('data-theme')==='dark') root.removeAttribute('data-theme');
    else root.setAttribute('data-theme','dark');
  });

  // ===== è¥¿æ´‹ï¼šå¤ªé™½æ˜Ÿåº§ï¼ˆä¸€èˆ¬çš„ãªæ—¥ä»˜ç¯„å›²ï¼‰
  const sunSigns = [
    {name:"ç‰¡ç¾Šåº§", from:"03-21", to:"04-19", element:"ç«"},
    {name:"ç‰¡ç‰›åº§", from:"04-20", to:"05-20", element:"åœ°"},
    {name:"åŒå­åº§", from:"05-21", to:"06-21", element:"é¢¨"},
    {name:"èŸ¹åº§",   from:"06-22", to:"07-22", element:"æ°´"},
    {name:"ç…å­åº§", from:"07-23", to:"08-22", element:"ç«"},
    {name:"ä¹™å¥³åº§", from:"08-23", to:"09-22", element:"åœ°"},
    {name:"å¤©ç§¤åº§", from:"09-23", to:"10-23", element:"é¢¨"},
    {name:"è åº§",   from:"10-24", to:"11-22", element:"æ°´"},
    {name:"å°„æ‰‹åº§", from:"11-23", to:"12-21", element:"ç«"},
    {name:"å±±ç¾Šåº§", from:"12-22", to:"01-19", element:"åœ°"},
    {name:"æ°´ç“¶åº§", from:"01-20", to:"02-18", element:"é¢¨"},
    {name:"é­šåº§",   from:"02-19", to:"03-20", element:"æ°´"},
  ];
  function getSunSign(d){
    const y = d.getFullYear();
    const md = (m,dd)=> new Date(`${y}-${m}-${dd}T00:00:00`);
    for(const s of sunSigns){
      let from = md(...s.from.split("-"));
      let to   = md(...s.to.split("-"));
      if(s.from > s.to){
        const endThis = md("12","31");
        const startThis = md("01","01");
        if(d>=from && d<=endThis) return s;
        if(d>=startThis && d<=to) return s;
      } else {
        if(d>=from && d<=to) return s;
      }
    }
    return null;
  }

  // ===== è¥¿æ´‹ï¼šæœˆæ˜Ÿåº§ï¼ˆç°¡æ˜“æ¨å®šï¼‰
  const moonRanges = [
    {name:"ç‰¡ç¾Šåº§", ranges:[["01-01","01-02"],["01-28","01-30"],["02-24","02-26"],["03-23","03-25"],["04-19","04-21"],["05-16","05-18"],["06-12","06-14"],["07-09","07-11"],["08-05","08-07"],["09-01","09-03"],["09-28","09-30"],["10-25","10-27"],["11-21","11-23"],["12-18","12-20"]]},
    {name:"ç‰¡ç‰›åº§", ranges:[["01-02","01-04"],["01-30","02-01"],["02-26","02-28"],["03-25","03-27"],["04-21","04-23"],["05-18","05-20"],["06-14","06-16"],["07-11","07-13"],["08-07","08-09"],["09-03","09-05"],["09-30","10-02"],["10-27","10-29"],["11-23","11-25"],["12-20","12-22"]]},
    {name:"åŒå­åº§", ranges:[["01-04","01-06"],["02-01","02-03"],["02-28","03-01"],["03-27","03-29"],["04-23","04-25"],["05-20","05-22"],["06-16","06-18"],["07-13","07-15"],["08-09","08-11"],["09-05","09-07"],["10-02","10-04"],["10-29","10-31"],["11-25","11-27"],["12-22","12-24"]]},
    {name:"èŸ¹åº§",   ranges:[["01-06","01-08"],["02-03","02-05"],["03-01","03-03"],["03-29","03-31"],["04-25","04-27"],["05-22","05-24"],["06-18","06-20"],["07-15","07-17"],["08-11","08-13"],["09-07","09-09"],["10-04","10-06"],["10-31","11-02"],["11-27","11-29"],["12-24","12-26"]]},
    {name:"ç…å­åº§", ranges:[["01-08","01-10"],["02-05","02-07"],["03-03","03-05"],["03-31","04-02"],["04-27","04-29"],["05-24","05-26"],["06-20","06-22"],["07-17","07-19"],["08-13","08-15"],["09-09","09-11"],["10-06","10-08"],["11-02","11-04"],["11-29","12-01"],["12-26","12-28"]]},
    {name:"ä¹™å¥³åº§", ranges:[["01-10","01-12"],["02-07","02-09"],["03-05","03-07"],["04-02","04-04"],["04-29","05-01"],["05-26","05-28"],["06-22","06-24"],["07-19","07-21"],["08-15","08-17"],["09-11","09-13"],["10-08","10-10"],["11-04","11-06"],["12-01","12-03"],["12-28","12-30"]]},
    {name:"å¤©ç§¤åº§", ranges:[["01-12","01-14"],["02-09","02-11"],["03-07","03-09"],["04-04","04-06"],["05-01","05-03"],["05-28","05-30"],["06-24","06-26"],["07-21","07-23"],["08-17","08-19"],["09-13","09-15"],["10-10","10-12"],["11-06","11-08"],["12-03","12-05"],["12-30","12-31"]]},
    {name:"è åº§",   ranges:[["01-14","01-16"],["02-11","02-13"],["03-09","03-11"],["04-06","04-08"],["05-03","05-05"],["05-30","06-01"],["06-26","06-28"],["07-23","07-25"],["08-19","08-21"],["09-15","09-17"],["10-12","10-14"],["11-08","11-10"],["12-05","12-07"]]},
    {name:"å°„æ‰‹åº§", ranges:[["01-16","01-18"],["02-13","02-15"],["03-11","03-13"],["04-08","04-10"],["05-05","05-07"],["06-01","06-03"],["06-28","06-30"],["07-25","07-27"],["08-21","08-23"],["09-17","09-19"],["10-14","10-16"],["11-10","11-12"],["12-07","12-09"]]},
    {name:"å±±ç¾Šåº§", ranges:[["01-18","01-20"],["02-15","02-17"],["03-13","03-15"],["04-10","04-12"],["05-07","05-09"],["06-03","06-05"],["06-30","07-02"],["07-27","07-29"],["08-23","08-25"],["09-19","09-21"],["10-16","10-18"],["11-12","11-14"],["12-09","12-11"]]},
    {name:"æ°´ç“¶åº§", ranges:[["01-20","01-22"],["02-17","02-19"],["03-15","03-17"],["04-12","04-14"],["05-09","05-11"],["06-05","06-07"],["07-02","07-04"],["07-29","07-31"],["08-25","08-27"],["09-21","09-23"],["10-18","10-20"],["11-14","11-16"],["12-11","12-13"]]},
    {name:"é­šåº§",   ranges:[["01-22","01-24"],["02-19","02-21"],["03-17","03-19"],["04-14","04-16"],["05-11","05-13"],["06-07","06-09"],["07-04","07-06"],["07-31","08-02"],["08-27","08-29"],["09-23","09-25"],["10-20","10-22"],["11-16","11-18"],["12-13","12-15"]]},
  ];
  function inRange(date, start, end){
    const y = date.getFullYear();
    const s = new Date(`${y}-${start}T00:00:00`);
    const e = new Date(`${y}-${end}T23:59:59`);
    return date>=s && date<=e;
  }
  function getMoonSignApprox(d){
    for(const m of moonRanges){
      for(const [s,e] of m.ranges){ if(inRange(d,s,e)) return m.name; }
    }
    return "ï¼ˆæ¨å®šä¸å¯ï¼šç²¾å¯†ç‰ˆã§åˆ¤å®šï¼‰";
  }

  // ===== å››æŸ±ï¼šå¹´æŸ±ï¼ˆå¹²æ”¯ãƒ»ç°¡æ˜“ï¼‰
  const stems = ["ç”²","ä¹™","ä¸™","ä¸","æˆŠ","å·±","åºš","è¾›","å£¬","ç™¸"];
  const branches = ["å­","ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"];
  const stemElement = { "ç”²":"æœ¨","ä¹™":"æœ¨","ä¸™":"ç«","ä¸":"ç«","æˆŠ":"åœŸ","å·±":"åœŸ","åºš":"é‡‘","è¾›":"é‡‘","å£¬":"æ°´","ç™¸":"æ°´" };
  function ganzhiYear(year){
    const idx = (year - 4) % 60; // 4å¹´=ç”²å­
    const stem = stems[idx % 10];
    const branch = branches[idx % 12];
    return { stem, branch, label: stem + branch, element: stemElement[stem] };
  }

  // ===== è¦ç‚¹ã‚«ãƒ¼ãƒ‰ç”Ÿæˆ
  function westernCards(sun, moonName){
    const e = sun?.element || "â€”";
    const sunLine = `ğŸŒ å¤ªé™½ï¼š<span class="hl">${sun?sun.name:"ä¸æ˜"}</span>ï¼ˆã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆï¼š${e}ï¼‰`;
    const moonLine = `ğŸŒ™ æœˆï¼š<span class="hl">${moonName}</span>`;
    const bullets = [];
    if(e==="ç«") bullets.push("è¡Œå‹•åŠ›ã¨ç›´æ„Ÿã‚’è»¸ã«å‹•ã");
    if(e==="åœ°") bullets.push("å®‰å®šã¨ç¾å®Ÿæ€§ã‚’é‡è¦–ã€å½¢ã«ã™ã‚‹åŠ›");
    if(e==="é¢¨") bullets.push("çŸ¥æ€§ãƒ»å¯¾è©±ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒå¾—æ„");
    if(e==="æ°´") bullets.push("å…±æ„ŸåŠ›ã¨æƒ³åƒåŠ›ãŒè±Šã‹");
    return `<div class="pill">è¥¿æ´‹ï¼šæ€§æ ¼ã®æ ¸</div>
      <p>${sunLine}<br>${moonLine}</p>
      <ul class="bullet">${bullets.map(b=>`<li>${b}</li>`).join('')}</ul>`;
  }
  function easternCards(gy){
    const line1 = `ğŸ“… å¹´æŸ±ï¼š<span class="hl">${gy.label}</span>ï¼ˆäº”è¡Œï¼š${gy.element}ï¼‰`;
    const tips = {"æœ¨":"æˆé•·ãƒ»ç™ºå±•ãƒ»å­¦ã³ãŒéµ","ç«":"æƒ…ç†±ãƒ»è¡¨ç¾ãƒ»è‡ªå·±ä¸»å¼µãŒéµ","åœŸ":"å®‰å®šãƒ»èª¿æ•´ãƒ»ç¶™ç¶šåŠ›ãŒéµ","é‡‘":"è¦å¾‹ãƒ»å¯©ç¾çœ¼ãƒ»æ´—ç·´ãŒéµ","æ°´":"æŸ”è»Ÿãƒ»ç›´æ„Ÿãƒ»ç ”ç©¶ãŒéµ"}[gy.element] || "ãƒãƒ©ãƒ³ã‚¹ã‚ˆãè¦ç´ ã‚’æ´»ã‹ã™";
    return `<div class="pill">å››æŸ±ï¼šç¤¾ä¼šçš„ã‚­ãƒ£ãƒ©ï¼ˆå¹´æŸ±ï¼‰</div><p>${line1}</p><ul class="bullet"><li>${tips}</li></ul>`;
  }
  function hybridCards(sun, moonName, gy){
    const e = sun?.element || "â€”";
    const items = [];
    let face = "å¤šé¢çš„";
    if(e==="åœ°" && gy.element==="åœŸ") face = "è½ã¡ç€ãÃ—å …å®Ÿï¼ˆä¿¡é ¼æ„Ÿã®ã‚ã‚‹è¡¨ã®é¡”ï¼‰";
    if(e==="ç«" && gy.element==="ç«") face = "æƒ…ç†±Ã—æ¨é€²åŠ›ï¼ˆç‰½å¼•å½¹ã®è¡¨ã®é¡”ï¼‰";
    if(e==="é¢¨" && gy.element==="é‡‘") face = "çŸ¥æ€§Ã—ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆç†è·¯æ•´ç„¶ã¨ã—ãŸè¡¨ã®é¡”ï¼‰";
    if(e==="æ°´" && gy.element==="æ°´") face = "å…±æ„ŸÃ—æ´å¯Ÿï¼ˆç™’ã‚„ã—ç³»ã®è¡¨ã®é¡”ï¼‰";
    items.push(`<li>â­ è¡¨ã®é¡”ï¼š${face}</li>`);
    let inner = "æ„Ÿæƒ…ã®å‹•ãã¯çŠ¶æ³æ¬¡ç¬¬";
    if(moonName.includes("èŸ¹")) inner = "å®¶æ—æ€ã„ãƒ»å®ˆã‚Šã®æƒ…ãŒæ·±ã„";
    if(moonName.includes("è ")) inner = "çµ†ã‚’é‡ã‚“ã˜ã‚‹ãƒ»ä¸€é€”";
    if(moonName.includes("é­š")) inner = "å…±æ„Ÿçš„ãƒ»ãƒ­ãƒãƒ³ãƒã‚¹ãƒˆ";
    if(moonName.includes("ç‰¡ç¾Š")) inner = "ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆã§ç†±ã„";
    if(moonName.includes("ç…å­")) inner = "è‡ªå°Šå¿ƒãŒé«˜ããƒ‰ãƒ©ãƒãƒãƒƒã‚¯";
    if(moonName.includes("å°„æ‰‹")) inner = "è‡ªç”±å¿—å‘ã§æ¥½è¦³çš„";
    if(moonName.includes("åŒå­")) inner = "çŸ¥çš„å¥½å¥‡å¿ƒãŒå¼·ãåˆ‡æ›¿ãŒé€Ÿã„";
    if(moonName.includes("å¤©ç§¤")) inner = "èª¿å’Œå¿—å‘ãƒ»äººé–“é–¢ä¿‚ã®ãƒãƒ©ãƒ³ã‚¹é‡è¦–";
    if(moonName.includes("æ°´ç“¶")) inner = "ç‹¬å‰µçš„ãƒ»è·é›¢æ„Ÿä¸Šæ‰‹";
    if(moonName.includes("ç‰¡ç‰›")) inner = "äº”æ„ŸãŒè±Šã‹ãƒ»å®‰å®šå¿—å‘";
    if(moonName.includes("ä¹™å¥³")) inner = "ç¹Šç´°ã§åˆ†æçš„";
    if(moonName.includes("å±±ç¾Š")) inner = "è²¬ä»»æ„ŸãŒå¼·ãè‡ªåˆ¶çš„";
    items.push(`<li>ğŸ’– å†…é¢ï¼š${inner}</li>`);
    let strength = "çŠ¶æ³æŠŠæ¡ã¨é©å¿œåŠ›";
    if(e==="åœ°") strength = "ç¶™ç¶šåŠ›ãƒ»å½¢ã«ã™ã‚‹åŠ›";
    if(e==="ç«") strength = "çªç ´åŠ›ãƒ»èµ·çˆ†åŠ›";
    if(e==="é¢¨") strength = "æƒ…å ±ç·¨é›†ãƒ»èª¬æ˜åŠ›";
    if(e==="æ°´") strength = "å…±æ„Ÿãƒ»ç™’ã—ãƒ»å‰µä½œ";
    if(gy.element==="é‡‘") strength += "ï¼ãƒ«ãƒ¼ãƒ«é‹ç”¨ãƒ»å¯©ç¾çœ¼";
    if(gy.element==="æœ¨") strength += "ï¼å­¦ç¿’ã¨æˆé•·ã‚¹ãƒ”ãƒ¼ãƒ‰";
    items.push(`<li>ğŸ’¡ å¼·ã¿ï¼š${strength}</li>`);
    let weakness = "ãƒãƒ©ãƒ³ã‚¹é…åˆ†ï¼ˆä¼‘æ¯ã¨é›†ä¸­ï¼‰";
    if(e==="åœ°") weakness = "å¤‰åŒ–ã¸ã®è…°ã®é‡ã•";
    if(e==="ç«") weakness = "è¡å‹•ãƒ»ç‡ƒãˆå°½ã";
    if(e==="é¢¨") weakness = "æ•£æ¼«ãƒ»æ·±æ˜ã‚Šä¸è¶³";
    if(e==="æ°´") weakness = "æ„Ÿæƒ…ã®é£²ã¿è¾¼ã¿ã™ã";
    items.push(`<li>âš ï¸ èª²é¡Œï¼š${weakness}</li>`);
    return `<div class="pill">æ˜ŸæŸ±ã‚¯ãƒ­ã‚¹è¨ºæ–­</div><ul class="bullet">${items.join('')}</ul><p class="kicker">â€»ç²¾å¯†ç‰ˆã§ã¯ã€å››æŸ±ã®æœˆæŸ±/æ—¥æŸ±ã¨è¥¿æ´‹ã®é‡‘æ˜Ÿ/ç«æ˜Ÿãƒ»ASC/ãƒã‚¦ã‚¹ãƒ»ã‚¢ã‚¹ãƒšã‚¯ãƒˆã‚’çµ±åˆã€‚</p>`;
  }

  // ===== å…±æœ‰ç”¨ãƒ†ã‚­ã‚¹ãƒˆ
  function composeShareText(){
    const summaryText = document.getElementById('summary').innerText.trim();
    const westernText = document.getElementById('western').innerText.trim();
    const easternText = document.getElementById('eastern').innerText.trim();
    const hybridText  = document.getElementById('hybrid').innerText.trim();
    return `ã€æ˜ŸæŸ±è¡“ï½œæ€§æ ¼è¨ºæ–­ã€‘\n\n${summaryText}\n\nâ–¼è¥¿æ´‹æ€§æ ¼\n${westernText}\n\nâ–¼å››æŸ±æ€§æ ¼\n${easternText}\n\nâ–¼æ˜ŸæŸ±ã‚¯ãƒ­ã‚¹è¨ºæ–­\n${hybridText}`;
  }
  function generateShareLink(){
    const text = composeShareText();
    return "https://twitter.com/intent/tweet?text=" + encodeURIComponent(text);
  }
  function copyToClipboard(text){
    navigator.clipboard?.writeText(text).then(()=>showToast('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ')).catch(()=>{
      const ta = document.createElement('textarea');
      ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); showToast('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
    });
  }
  function showToast(msg){
    const t = document.getElementById('toast');
    t.textContent = msg; t.classList.add('show');
    setTimeout(()=> t.classList.remove('show'), 1500);
  }

  // ===== è¨ˆç®—
  function onCalc(){
    const dateStr = document.getElementById('birthDate').value;
    if(!dateStr){ showToast('ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
    const d = new Date(dateStr + "T12:00:00");
    const sun = getSunSign(d);
    const moonName = getMoonSignApprox(d);
    const gy = ganzhiYear(d.getFullYear());

    const place = document.getElementById('birthPlace').value;
    const time  = document.getElementById('birthTime').value;

    document.getElementById('summary').innerHTML = `
      <div class="tag">${dateStr}</div>
      ${time ? `<div class=\"tag\">${time}</div>` : ``}
      ${place ? `<div class=\"tag\">${place}</div>` : ``}
      <div class="tag">å¤ªé™½ï¼š${sun?sun.name:"â€”"}</div>
      <div class="tag">æœˆï¼ˆæ¨å®šï¼‰ï¼š${moonName}</div>
      <div class="tag">å¹´æŸ±ï¼š${gy.label}</div>
    `;
    document.getElementById('western').innerHTML = westernCards(sun, moonName);
    document.getElementById('eastern').innerHTML = easternCards(gy);
    document.getElementById('hybrid').innerHTML  = hybridCards(sun, moonName, gy);

    const result = document.getElementById('result');
    result.style.display = 'block';
    window.scrollTo({top: result.offsetTop - 10, behavior:'smooth'});
  }

  // ===== ã‚¤ãƒ™ãƒ³ãƒˆçµç·š
  document.getElementById('calcBtn').addEventListener('click', onCalc);
  document.getElementById('resetBtn').addEventListener('click', ()=>{
    ['birthDate','birthTime','birthPlace'].forEach(id=> document.getElementById(id).value='');
    document.getElementById('result').style.display='none';
  });
  document.getElementById('shareBtn').addEventListener('click', (e)=>{
    e.preventDefault(); window.open(generateShareLink(),'_blank');
  });
  document.getElementById('copyBtn').addEventListener('click', ()=>{
    copyToClipboard(composeShareText());
  });
</script>
</body>
</html>
